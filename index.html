<!DOCTYPE html>
<html lang="en">

<!-- todo
  - info wenn screen zu schmal
  - file formatierung und ausmisten und ordnen
  - lade screen währen fetch - aber nur der spinner soll sich drehen, nicht der text :)
  - hatte fehler, als bei erstem aufruf leere arrays zurück kamen. evtl mal fest setzten und dann testen -
  - - > vermutlich wird room name auf undefined gesetzt und dieser raum dann beim erstellen angelegt
  - - > evtl noch bug, wenn zuerset 401 nicht angemeldet kommt 
  - f5 ruhiger macher (menu flakkert)
- ' und "
-- css änderung, wenn neue nachricht von user kommt (neben usernamen) 
- "welcome screen"
- join notifications nur innerhalb eines raums
- wss wenn neue nachricht

  was hab ich gemacht
  - erstmal protptyp (wie funktioniert was)
  - dann plan, was muss ich alles machen + implementierung des plans
  - annahme: 
      1. user darf nur in einem raum gleichzeitig sein (wäre auch anders gegangen)
      2. es darf keinen raum mit dem namen "" (leer) geben
  - erste überlegungungen für zusatzfunktionen: ba
  - gründe für: 
      1. device flow user wird nicht zurück gegeben (änderung an api)
      2. logged in ist redundant, da ja header entsprechend zurückgegeben wird
  - request bei raumwechsel:
          von adsdad
          1. 204 ???
          2. post in neuen raum
          3. hole user in raum
          4. starte alten websocket
          5. verlasse alten raum
          6. lese nachrichten im raum
          7. starte message websocket
          8. starte info websocket
          nach anuerk



          https://www.pluralsight.com/guides/handling-nested-http-requests-using-the-fetch-api

-->

<head>
  <meta charset="UTF-8" />
  <title>Webprommierung</title>
  <link rel="stylesheet" href="css/style.css" />
  <script src="js/script.js"></script>
  <script src="https://kit.fontawesome.com/54e3d558c8.js" crossorigin="anonymous"></script>
</head>

<body>
  <!-- div for the header and functions-->
  <div class="wrapper">
    <!-- will be displayed if user is not logged in-->
    <div id="overlay">
      <div id="login_info"><br />
        <button style="display:none" id="logged_in" onclick="display_login('','',true)">Gemacht :)</button>
      </div>
    </div>

    <!-- body-->
    <div id="container">
      <!-- rooms-->
      <div id="menu">
        <div id="rooms">
          <h2>rooms</h2>
          <hr>
          <ul>
            <li>
              <input type="text" name="new_room" id="new_room">
              <button value="add" class="fas fa-plus" aria-hidden="true">add</button>
            </li>
          </ul>
        </div>
        <div id="private_chats">
          <h2>private chats</h2><!--  todo label -->
          <ul class="private_chats_ul">
          </ul>
        </div>
      </div>
      <!-- chat-->
      <div id="chat">
        <div id="chat_history">
          <div id="room_header">           
          </div>
        </div>
        <div id="chat_new">
          <hr>
          <label for="chat_input">chat:</label> <!--  todo label -->
          <textarea id="chat_input" name="chat_input" rows="4" cols="50"></textarea><br />
          <label for="chat_send">send your message</label> <!--  todo label -->
          <button type="button" id="chat_send" onclick="send_message_in_room()">Send</button>
        </div>
      </div>
    </div>
  </div>
</body>
<!-- todo only if logged in -->
<script>
  (async () => {
    show_loading(true)
    await init()
    
    document.getElementById("chat_history").innerHTML =labels.welcome
    
    if(current_user){
      show_loading(false)
    }
  })();
</script>

</html>